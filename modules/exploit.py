import streamlit as st,subprocess,shlex
from modules.base import BaseModule,ModuleRegistry
class ExploitModule(BaseModule):
    def __init__(self):
        super().__init__("Exploit","exploit"); ModuleRegistry.register(self)
    def _search(self,q):
        try: return subprocess.check_output(["searchsploit","-w","--json",q],text=True)
        except Exception as e: return str(e)
    def render(self):
        st.header("Exploit"); q=st.text_input("Query"); 
        if st.button("Search"): st.text(self.run_and_store(q,self._search,q))
ExploitModule()