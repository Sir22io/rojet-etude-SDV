import streamlit as st
import subprocess, shlex
from modules.base import BaseModule, ModuleRegistry

class ExploitModule(BaseModule):
    def __init__(self):
        super().__init__(name="Exploit", key_prefix="exploit")
        ModuleRegistry.register(self)

    def _searchsploit(self, q: str):
        cmd = ["searchsploit", "-w", "--json", q]
        try:
            return subprocess.check_output(cmd, text=True)
        except Exception as e:
            return str(e)

    def render(self):
        st.header("ðŸ’£ Exploit Search")
        q = st.text_input("Query", placeholder="apache 2.4.56")
        if st.button("Search", key="exp_btn") and q:
            out = self.run_and_store(q, self._searchsploit, q)
            st.text(out)

ExploitModule()
